using System;
using System.CodeDom.Compiler;
using System.ComponentModel;
using System.Diagnostics;
using System.Globalization;
using System.Management;
using System.Net;
using System.Runtime.CompilerServices;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using System.Windows.Markup;
using System.Windows.Media.Animation;

namespace Perth
{
	// Token: 0x02000002 RID: 2
	public partial class KeySys : Window
	{
		// Token: 0x06000002 RID: 2 RVA: 0x00002058 File Offset: 0x00000258
		public KeySys()
		{
			this.InitializeComponent();
			if (!(KeySys.HttpGet("https://ksapi.xyz/PSU/Verify.php?HardwareID=" + this.HWID) != this.HWID))
			{
				Window window = new MainWindow();
				base.Close();
				window.Show();
				return;
			}
		}

		// Token: 0x06000003 RID: 3 RVA: 0x00002101 File Offset: 0x00000301
		public static string Base64Encode(string plainText)
		{
			return Convert.ToBase64String(Encoding.UTF8.GetBytes(plainText)).Replace("=", "1");
		}

		// Token: 0x06000004 RID: 4 RVA: 0x00002124 File Offset: 0x00000324
		public static string HttpGet(string Url)
		{
			WebClient webClient = new WebClient();
			string result = webClient.DownloadString(Url);
			webClient.Dispose();
			return result;
		}

		// Token: 0x06000005 RID: 5 RVA: 0x00002144 File Offset: 0x00000344
		private void Exit(object sender, RoutedEventArgs e)
		{
			Process.GetCurrentProcess().Kill();
		}

		// Token: 0x17000001 RID: 1
		// (get) Token: 0x06000006 RID: 6 RVA: 0x00002150 File Offset: 0x00000350
		// (set) Token: 0x06000007 RID: 7 RVA: 0x00002158 File Offset: 0x00000358
		private IEasingFunction MarginEasing { get; set; } = new QuarticEase
		{
			EasingMode = EasingMode.EaseInOut
		};

		// Token: 0x06000008 RID: 8 RVA: 0x00002164 File Offset: 0x00000364
		public void Shifter(DependencyObject Object, Thickness Get, Thickness Set)
		{
			KeySys.<Shifter>d__10 <Shifter>d__;
			<Shifter>d__.<>t__builder = AsyncVoidMethodBuilder.Create();
			<Shifter>d__.<>4__this = this;
			<Shifter>d__.Object = Object;
			<Shifter>d__.Get = Get;
			<Shifter>d__.Set = Set;
			<Shifter>d__.<>1__state = -1;
			<Shifter>d__.<>t__builder.Start<KeySys.<Shifter>d__10>(ref <Shifter>d__);
		}

		// Token: 0x06000009 RID: 9 RVA: 0x000021B4 File Offset: 0x000003B4
		private void Button_Click(object sender, RoutedEventArgs e)
		{
			if (this.TextBox1.Text == "")
			{
				MessageBox.Show("Please enter something as a key.", "Key", MessageBoxButton.OK, MessageBoxImage.Hand);
				return;
			}
			if (!(KeySys.HttpGet("https://ksapi.xyz/PSU/Verify.php?HardwareID=" + this.HWID) != this.HWID))
			{
				Window window = new MainWindow();
				base.Close();
				window.Show();
				return;
			}
			this.FailedTries++;
			if (this.FailedTries == 3)
			{
				MessageBox.Show("Your key was incorrect again. If you need help, please join our discord server & then create a support ticket.", "Key", MessageBoxButton.OK, MessageBoxImage.Asterisk);
				this.FailedTries = 0;
				return;
			}
			MessageBox.Show("The key: \"" + this.TextBox1.Text + "\" is invalid.", "Key", MessageBoxButton.OK, MessageBoxImage.Hand);
		}

		// Token: 0x0600000A RID: 10 RVA: 0x00002279 File Offset: 0x00000479
		private void Button_Click_1(object sender, RoutedEventArgs e)
		{
			Process.Start("https://ksapi.xyz/PSU/Start.php?HardwareID=" + this.HWID);
		}

		// Token: 0x0600000B RID: 11 RVA: 0x00002291 File Offset: 0x00000491
		private void Grid_MouseDown(object sender, MouseButtonEventArgs e)
		{
			if (e.ChangedButton == MouseButton.Left)
			{
				base.DragMove();
			}
		}

		// Token: 0x0600000C RID: 12 RVA: 0x00002144 File Offset: 0x00000344
		private void Execute_Copy_MouseDown(object sender, MouseButtonEventArgs e)
		{
			Process.GetCurrentProcess().Kill();
		}

		// Token: 0x04000001 RID: 1
		public string HWID = KeySys.Base64Encode(Environment.UserName + long.Parse(new ManagementObject("win32_logicaldisk.deviceid=\"c:\"")["VolumeSerialNumber"].ToString(), NumberStyles.HexNumber).ToString());

		// Token: 0x04000002 RID: 2
		private Storyboard StoryBoard = new Storyboard();

		// Token: 0x04000004 RID: 4
		private int FailedTries;
	}
}
